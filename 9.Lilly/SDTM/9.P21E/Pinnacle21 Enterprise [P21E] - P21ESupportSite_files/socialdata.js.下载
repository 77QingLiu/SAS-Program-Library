function ULSqvN(){var o=new Object;o.ULSTeamName="SharePoint Portal Server";o.ULSFileName="SocialData.js";return o;}
TagDialogOpener=function(){};TagDialogOpener.Open=function(d,b,c){ULSqvN:;var a=PageUrlNormalizer.GetInstance();a.GetUrl(d,function(a){ULSqvN:;OpenTRC(a,b,c)})};PageUrlNormalizer=function(){ULSqvN:;try{this._url=_normalizedPageUrlForSocialItem}catch(a){this._url=""}};PageUrlNormalizer._instance=null;PageUrlNormalizer.GetInstance=function(){ULSqvN:;if(PageUrlNormalizer._instance==null)PageUrlNormalizer._instance=new PageUrlNormalizer;return PageUrlNormalizer._instance};PageUrlNormalizer.EnsureUpdatedFormDigest=function(){ULSqvN:;typeof _spPageContextInfo!="undefined"&&typeof _spFormDigestRefreshInterval!="undefined"&&typeof UpdateFormDigest!="undefined"&&UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl,_spFormDigestRefreshInterval)};PageUrlNormalizer.prototype={_url:"",_rawUrl:"",_scriptService:"_vti_bin/socialdatainternalservice.json",_serviceMethod:"GetNormalizedPageUrl",GetUrl:function(d,a){ULSqvN:;if(this._url!=""){a&&a(this._url);return}this._rawUrl=d;var b=window._spPageContextInfo.webServerRelativeUrl,f=b.endsWith("/")?"":"/",e=b+f+this._scriptService;Sys.Net.WebRequestManager.add_invokingRequest(function(c,b){ULSqvN:;PageUrlNormalizer.EnsureUpdatedFormDigest();var a=$get("__REQUESTDIGEST");if(a)b.get_webRequest().get_headers()["X-RequestDigest"]=a.value});var c={};c["pageUrl"]=d;Sys.Net.WebServiceProxy.invoke(encodeURI(e),this._serviceMethod,false,c,Function.createDelegate(this,this._onSuccess),Function.createDelegate(this,this._onFailure),a)},_onSuccess:function(b,a){ULSqvN:;this._url=b;typeof a=="function"&&a(this._url)},_onFailure:function(c,a){ULSqvN:;typeof a=="function"&&a(this._rawUrl)}};function OpenTRC(d,c,a){ULSqvN:;if(a==undefined||a==null)a=1;var e=function(){ULSqvN:;var e=SP.Utilities.HttpUtility.urlPathEncode(window._spPageContextInfo.webServerRelativeUrl);e=SP.Utilities.UrlBuilder.urlCombine(e,"_layouts/socialdataframe.aspx");var b=new SP.Utilities.UrlBuilder(e);b.addKeyValueQueryString("Url",d);b.addKeyValueQueryString("Title",c);b.addKeyValueQueryString("mode",a.toString());var f={url:b.get_url(),args:null,title:c,width:600,height:470};SP.UI.ModalDialog.showModalDialog(f)},b;try{b=typeof SP.UI.ModalDialog.showModalDialog}catch(f){b="undefined"}EnsureScript("SP.UI.Dialog.js",b,e)}SocialNotification=function(){};SocialNotification._tid=null;SocialNotification._nid=null;SocialNotification._notificationText=null;SocialNotification._mouseoverTimer=500;SocialNotification._hoverTimer=5e3;SocialNotification._alertTimer=7e3;SocialNotification.alert=function(a){ULSqvN:;SocialNotification._clear();SocialNotification._nid=addNotification(a,true);SocialNotification._tid=window.setTimeout(SocialNotification._clearNotification,SocialNotification._alertTimer)};SocialNotification.onmouseover=function(a){ULSqvN:;SocialNotification._notificationText=a;SocialNotification._clearTimer();SocialNotification._tid=window.setTimeout(SocialNotification._fireNotification,SocialNotification._mouseoverTimer)};SocialNotification.onmouseout=function(){ULSqvN:;SocialNotification._clear()};SocialNotification._fireNotification=function(){ULSqvN:;SocialNotification._clear();SocialNotification._nid=addNotification(SocialNotification._notificationText,true);SocialNotification._tid=window.setTimeout(SocialNotification._clearNotification,SocialNotification._hoverTimer)};SocialNotification._clear=function(){ULSqvN:;SocialNotification._clearNotification();SocialNotification._clearTimer()};SocialNotification._clearNotification=function(){ULSqvN:;if(SocialNotification._nid!=null){removeNotification(SocialNotification._nid);SocialNotification._nid=null}};SocialNotification._clearTimer=function(){ULSqvN:;if(SocialNotification._tid!=null){window.clearTimeout(SocialNotification._tid);SocialNotification._tid=null}};SocialTagsAndNotes=function(a){ULSqvN:;this.ClientID=a;this._anchor=document.getElementById("TagsAndNotes_"+a)};SocialTagsAndNotes._scriptService="_vti_bin/socialdatainternalservice.json";SocialTagsAndNotes._serviceMethod="GetSocialNotification";SocialTagsAndNotes._hasIcon24="/_layouts/images/SocialTagsAndNotesHas_24.png";SocialTagsAndNotes._hasIcon32="/_layouts/images/SocialTagsAndNotesHas_32.png";SocialTagsAndNotes._replaceIcon=function(a){ULSqvN:;if(a!=null&&a.src!=null)if(a.src.lastIndexOf("_24")!=-1)a.src=SocialTagsAndNotes._hasIcon24;else{a.src=SocialTagsAndNotes._hasIcon32;a.style.top="";a.style.left="";a.style.position=""}};SocialTagsAndNotes.prototype={ClientID:null,url:null,tooltip:"",notify_text:"{0}",replaceImg_style:null,_anchor:null,GetSocialNotification:function(){ULSqvN:;if(this.url==null||this._anchor==null)return;this._anchor.onmouseover="";var a=PageUrlNormalizer.GetInstance();a.GetUrl(this.url,Function.createDelegate(this,this._onUrlNormalized))},_onUrlNormalized:function(c){ULSqvN:;var a=window._spPageContextInfo.webServerRelativeUrl,e=a.endsWith("/")?"":"/",d=a+e+SocialTagsAndNotes._scriptService;Sys.Net.WebRequestManager.add_invokingRequest(function(c,b){ULSqvN:;PageUrlNormalizer.EnsureUpdatedFormDigest();var a=$get("__REQUESTDIGEST");if(a)b.get_webRequest().get_headers()["X-RequestDigest"]=a.value});var b={};b["targetPage"]=c;Sys.Net.WebServiceProxy.invoke(encodeURI(d),SocialTagsAndNotes._serviceMethod,false,b,Function.createDelegate(this,this._onSuccess),Function.createDelegate(this,this._onFailure),null)},_onSuccess:function(b){ULSqvN:;this._wsSucceeded$2=true;var c=!isNaN(b)&&b>0?b:0;c>0&&SocialTagsAndNotes._replaceIcon(document.getElementById("TagsAndNotesImg_"+this.ClientID),this.replaceImg_style);var a=String.format(this.notify_text,c>1e3?"1000+":c)+"\n"+this.tooltip;if(this._anchor.title!="")this._anchor.title=a;else{SocialNotification.onmouseover(a);this._anchor.attachEvent("onmouseover",function(){ULSqvN:;SocialNotification.onmouseover(a)})}},_onFailure:function(){ULSqvN:;var a=this.tooltip;this._anchor.attachEvent("onmouseover",function(){ULSqvN:;SocialNotification.onmouseover(a)})}};SocialQuickTag=function(a){ULSqvN:;this.ClientID=a};SocialQuickTag._scriptService="_vti_bin/socialdatainternalservice.json";SocialQuickTag._serviceMethod="AddQuickTag";SocialQuickTag.prototype={ClientID:null,url:null,title:null,tagged_text:"",failure_text:"",replaceImg_style:null,_quickTagId:null,AddQuickTag:function(b){ULSqvN:;this._quickTagId=b;if(this.url==null||this.title==null||isNaN(this._quickTagId))return;var a=PageUrlNormalizer.GetInstance();a.GetUrl(this.url,Function.createDelegate(this,this._onUrlNormalized))},_onUrlNormalized:function(c){ULSqvN:;var b=window._spPageContextInfo.webServerRelativeUrl,e=b.endsWith("/")?"":"/",d=b+e+SocialQuickTag._scriptService;Sys.Net.WebRequestManager.add_invokingRequest(function(c,b){ULSqvN:;PageUrlNormalizer.EnsureUpdatedFormDigest();var a=$get("__REQUESTDIGEST");if(a)b.get_webRequest().get_headers()["X-RequestDigest"]=a.value});var a={};a["targetPage"]=c;a["title"]=this.title;a["quickTagId"]=this._quickTagId;Sys.Net.WebServiceProxy.invoke(encodeURI(d),SocialQuickTag._serviceMethod,false,a,Function.createDelegate(this,this._onSuccess),Function.createDelegate(this,this._onFailure),null)},_onSuccess:function(){ULSqvN:;this._wsSucceeded$2=true;SocialNotification.alert(this.tagged_text);SocialTagsAndNotes._replaceIcon(document.getElementById("TagsAndNotesImg_"+this.ClientID),this.replaceImg_style)},_onFailure:function(){ULSqvN:;SocialNotification.alert(this.failure_text)}};SocialTabSwitcher=function(){};SocialTabSwitcher._EventHandlers=null;SocialTabSwitcher.RegisterEventHandler=function(e,d,c,b){ULSqvN:;if(!SocialTabSwitcher._EventHandlers)SocialTabSwitcher._EventHandlers=[];var a={};a["TabId"]=e;a["ContentId"]=d;a["ActivateFunction"]=c;a["DeactivateFunction"]=b;SocialTabSwitcher._EventHandlers.push(a)};SocialTabSwitcher._GetEventHandler=function(d){ULSqvN:;if(!SocialTabSwitcher._EventHandlers)return null;for(var b=null,a=0;a<SocialTabSwitcher._EventHandlers.length;a++){var c=SocialTabSwitcher._EventHandlers[a];if(c["TabId"].toLowerCase()!=d.toLowerCase())continue;b=c}return b};SocialTabSwitcher.EnableTab=function(e){ULSqvN:;if(!e)return;var g=e.parentNode;if(!g)return;for(var f=[],j="ms-cui-tt ms-cui-tt-s",i="ms-cui-tt",d=0;d<g.childNodes.length;d++){var a=g.childNodes[d];if(!a||!a.tagName||a.tagName.toLowerCase()!="li")continue;var b=null,c=SocialTabSwitcher._GetEventHandler(a.id);if(c)b=document.getElementById(c["ContentId"]);if(a.id.toLowerCase()==e.id.toLowerCase()){a.className=j;if(b)b.style.display="block"}else{a.className=i;if(b){b.style.display!="none"&&f.push(c);b.style.display="none"}}}for(var d=0;d<f.length;d++){var c=f[d];c&&c["DeactivateFunction"]&&c["DeactivateFunction"]()}var h=SocialTabSwitcher._GetEventHandler(e.id);h&&h["ActivateFunction"]()};SocialProcessNotifier=function(){};SocialProcessNotifier._NotificationAreaId="notificationArea";SocialProcessNotifier._StatusAreaId="pageStatusBar";SocialProcessNotifier.prototype={_NotificationId:null,AlternateNotificationAreaId:null,AlternateStatusAreaId:null,UseAlternate:false,_NotificationAreaEnabled:function(){ULSqvN:;var a=document.getElementById(SocialProcessNotifier._NotificationAreaId);if(a)return true;else return false},AddNotification:function(b){ULSqvN:;if(this.UseAlternate||!this._NotificationAreaEnabled()){var a=document.getElementById(this.AlternateNotificationAreaId);if(!a)return;a.innerHTML=b}else if(this._NotificationAreaEnabled())this._NotificationId=addNotification(b,true)},RemoveNotification:function(){ULSqvN:;if(this.UseAlternate||!this._NotificationAreaEnabled()){var a=document.getElementById(this.AlternateNotificationAreaId);if(!a)return;a.innerHTML=""}else if(this._NotificationAreaEnabled()){if(this._NotificationId==undefined||this._NotificationId==null)return;removeNotification(this._NotificationId)}},_StatusAreaEnabled:function(){ULSqvN:;var a=document.getElementById(SocialProcessNotifier._StatusAreaId);if(a)return true;else return false},ShowStatus:function(b){ULSqvN:;if(this.UseAlternate||!this._StatusAreaEnabled()){var a=document.getElementById(this.AlternateStatusAreaId);if(!a)return;a.style.display="block"}else this._StatusAreaEnabled()&&addStatus("",b,true)},ClearStatus:function(){ULSqvN:;if(this.UseAlternate||!this._StatusAreaEnabled()){var a=document.getElementById(this.AlternateStatusAreaId);if(!a)return;a.style.display="none"}else this._StatusAreaEnabled()&&removeAllStatus(true)}};function TagCloudItemRank(c,e,d,f){ULSqvN:;var a=0,b=9;if(c==e)a=1+b/2;else{a=1+parseInt(parseFloat(b-1)*(d.Count-c)/(e-c));if(IsQuickTag(d,f)&&a>1+b/2)a=1+b/2}return a}function IsQuickTag(c,b){ULSqvN:;for(var a=0;a<b.length;a++){var d=b[a];if(c.Term.Name.toLowerCase()==d.toLowerCase())return true}return false}function TagCloudItemRender(h,g,c,f,b,e){ULSqvN:;var d=TagCloudItemRank(h,g,b,e),a="";if(c)a+='<a class="rank'+d.toString()+'" href="'+c+b.Term.Id+'">';else a+='<span class="rank'+d.toString()+'">';a+=STSHtmlEncode(b.Term.Name);if(f)a+="("+b.Count.toString()+")";if(c)a+="</a>";else a+="</span>";return a}function TagCloudItemsRender(a,k,i,j,l,h,g){ULSqvN:;var f=document.getElementById(j);if(!f)return;if(!a||a.length==0){f.innerHTML=k;return}a.sort(function(c,d){ULSqvN:;var a=c.Term.Name,b=d.Term.Name;return a.localeCompare(b)});for(var e=a[0].Count,d=a[0].Count,b=1;b<a.length;b++){if(e>a[b].Count)e=a[b].Count;if(d<a[b].Count)d=a[b].Count}var c='<div id="tagCloudData'+l+'" class="ms-TagCloud ms-TagCloudLink">';c+=TagCloudItemRender(e,d,i,h,a[0],g);for(var b=1;b<a.length;b++){c+='<span class="spacer"> </span>';c+=TagCloudItemRender(e,d,i,h,a[b],g)}c+="</div>";f.innerHTML=c}function TagCloudErrorRender(b,c){ULSqvN:;var a=document.getElementById(b);if(!a)return;var d="<span style='color: red;'>"+c+"</span>";a.innerHTML=d}NotifyScriptLoadedAndExecuteWaitingJobs("SocialData.js")